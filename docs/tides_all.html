<!doctype html>
<html lang="de"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gezeiten – Alle Komponenten</title>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script>tailwind.config={theme:{extend:{colors:{primary:'#002341',accent:'#007996',ink:'#111',border:'#e6e6e6',bg:'#fff'},boxShadow:{soft:'0 10px 30px rgba(0,0,0,.06)'},borderRadius:{'2xl':'1rem'},fontFamily:{sans:['Inter','system-ui','-apple-system','Segoe UI','Arial','sans-serif']}}}}</script>
</head><body class="bg-bg text-ink font-sans">
<main class="mx-auto max-w-6xl px-4 sm:px-6 py-8 space-y-6">
<header class="flex items-center justify-between"><h1 class="text-2xl font-semibold text-primary">Gezeiten – Komponenten</h1><a href="index.html" class="text-sm text-accent underline underline-offset-4">Zur Übersicht</a></header>
<section class="bg-white border border-border rounded-2xl p-6 shadow-soft"><h2 class="text-lg font-semibold text-primary">Badges & Timer</h2>
<div class="mt-3 flex flex-wrap items-center gap-3 text-sm">
<span id="badge-next-high" class="inline-flex items-center rounded-full bg-accent/10 text-accent px-3 py-1">Nächstes Hochwasser: —</span>
<span id="badge-next-low" class="inline-flex items-center rounded-full bg-primary/10 text-primary px-3 py-1">Nächstes Niedrigwasser: —</span>
<span id="badge-next" class="inline-flex items-center rounded-full bg-ink/10 text-ink px-3 py-1">Nächste Tide: —</span>
<span id="timer" class="inline-flex items-center rounded-full bg-ink/5 text-ink px-3 py-1">Countdown: —</span></div></section>
<section class="bg-white border border-border rounded-2xl p-6 shadow-soft"><h2 class="text-lg font-semibold text-primary">Gezeiten-Slider (max 7 Tage)</h2>
<div id="slider" class="mt-4 overflow-hidden"><div id="slide-track" class="flex gap-4 transition-transform"></div></div>
<div class="mt-3 flex gap-2"><button id="prev" class="px-3 py-1 border border-border rounded-lg">◀</button><button id="next" class="px-3 py-1 border border-border rounded-lg">▶</button></div></section>
<section class="bg-white border border-border rounded-2xl p-6 shadow-soft"><h2 class="text-lg font-semibold text-primary">Verlaufskurve</h2><div id="curve" class="mt-4"></div></section>
</main>
<script type="module">
  import { loadTides, groupByLocalDay, nextEvents, fmtLocal, humanCountdown, sampleTideCurve, renderCurveSVG } from '../assets/js/tides.js';
  const data = await loadTides('../data/tides.json'); const { extremes } = data;
  const { nextHigh, nextLow, next } = nextEvents(extremes);
  if (nextHigh) document.getElementById('badge-next-high').textContent = 'Nächstes Hochwasser: ' + fmtLocal(nextHigh.dt);
  if (nextLow)  document.getElementById('badge-next-low').textContent  = 'Nächstes Niedrigwasser: ' + fmtLocal(nextLow.dt);
  if (next)     document.getElementById('badge-next').textContent      = 'Nächste Tide: ' + (next.type==='High'?'Hoch':'Niedrig') + ' · ' + fmtLocal(next.dt);
  function tick(){ if (next) document.getElementById('timer').textContent = 'Countdown: ' + humanCountdown(next.dt); }
  tick(); setInterval(tick, 1000);
  const map = groupByLocalDay(extremes); const days = [...map.entries()].slice(0,7);
  const track = document.getElementById('slide-track');
  for (const [key, items] of days) {
    const rows = items.sort((a,b)=>a.dt-b.dt).map(e=>`
      <div class="rounded-xl border border-border p-3">
        <div class="text-xs text-ink/60">${e.type==='High'?'Hochwasser':'Niedrigwasser'}</div>
        <div class="text-lg font-semibold">${fmtLocal(e.dt)}</div>
        <div class="text-xs text-ink/60">${e.height!=null? (e.height.toFixed(2)+' m') : ''}</div>
      </div>`).join('');
    const card = document.createElement('div');
    card.className = 'min-w-[280px] sm:min-w-[360px] rounded-2xl border border-border p-4';
    card.innerHTML = `<div class="text-sm font-semibold text-primary">${key}</div><div class="mt-3 grid grid-cols-2 gap-3">${rows}</div>`;
    track.appendChild(card);
  }
  let idx = 0; function updateSlider(){ const cards=track.children.length; idx = Math.max(0, Math.min(idx, cards-1)); const cardW = track.children[0]?.getBoundingClientRect().width || 320; track.style.transform = `translateX(${-idx*(cardW+16)}px)`; }
  document.getElementById('prev').onclick = ()=>{ idx--; updateSlider(); }; document.getElementById('next').onclick = ()=>{ idx++; updateSlider(); };
  updateSlider(); window.addEventListener('resize', updateSlider);
  const pts = sampleTideCurve(extremes, 10); renderCurveSVG(document.getElementById('curve'), pts, { width: 900, height: 220 });
</script></body></html>
